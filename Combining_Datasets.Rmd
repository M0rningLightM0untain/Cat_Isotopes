---
title: "Combining_Datasets"
author: "Jack Sudds"
date: "08/08/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Packages}
library(tidyverse) #install.packages("tidyverse")
library(readxl) #install.packages("readxl")
library(here) #install.packages("here")
library(janitor) #install.packages("janitor")
library(kableExtra) #install.packages("kableExtra")
library(skimr) #install.packages("skimr")
library(dplyr)
library(data.table)#install.packages("data.table")
```

```{r importing_data}

j_samples <- read_excel(here("data", "Samples_Master.xlsx"), sheet = "Jack_samples", n_max = 109)
m_list_samples <- read_excel(here("data", "Samples_Master.xlsx"), sheet = "Masterlist_samples", n_max = 49)

#cleaning the names
j_samples <- j_samples %>%
  janitor::clean_names()
m_list_samples <- m_list_samples %>%
  janitor::clean_names()
```

```{r tidying_samples_up}

#unifying column names
j_samples <- j_samples %>%
  rename(do1_code=sample_id_d01_number)
 
m_list_samples <- m_list_samples %>%
  rename(sample_no=sample_number)
```

```{r combining}


#joining the two together
tot_samples <- m_list_samples %>%
  full_join(j_samples, by = c("sample_no", "do1_code", "site", "secondary_code", "period", "date", "element", "d13c", "d15n"))
```

```{r sorting&fixes}
###TO DO
  
```

```{r sorted into groups by period etc.}
#creating individual groups by period
tot_samples_grouped <- tot_samples %>%
  arrange(period)

cats_Anglo_Sax <- tot_samples %>%
  filter(period == "Anglo-Saxon") #%>% remove_empty(which = c("cols"), quiet = TRUE)

cats_Iron_Age <- tot_samples %>%
  filter(period == "Iron Age") #%>% remove_empty(which = c("cols"), quiet = TRUE)

cats_Medieval <- tot_samples %>%
  filter(period == "Medieval") #%>% remove_empty(which = c("cols"), quiet = TRUE)

cats_Post_Med <- tot_samples %>%
  filter(period == "Post-Medieval")#%>% remove_empty(which = c("cols"), quiet = TRUE)

cats_Roman <- tot_samples %>%
  filter(period == "Roman") #%>% remove_empty(which = c("cols"), quiet = TRUE)

cats_Modern_jsample <- tot_samples %>%
  filter(period == "Modern") #%>% remove_empty(which = c("cols"), quiet = TRUE)


```



```{r simple_graphs}
plot_set <- tot_samples

gg_base <- ggplot2::ggplot(data = plot_set, aes(x = d13c, y = d15n))

##now that is done time to make some graphs
gg_base +
  geom_point() +
  aes() +
      theme_classic() +
      labs(
        x = "δ13C‰",
        y = "δ15N‰",
        title = "Basic plot of tested samples",
        subtitle = "As of 08/08/2020")
      #ggsave(here("figures", "basic_all_tested.jpg"), dpi = 180, width = 8, height = 7)
    
##that worked like a charm now for more complexity
gg_base +
  geom_point() +
  aes(
    color = period
  ) +
      theme_classic() +
      labs(
        x = "δ13C‰",
        y = "δ15N‰",
        title = "Basic plot of tested samples by period",
        subtitle = "As of 08/08/2020")
      #ggsave(here("figures", "basic_all_tested_by_period .jpg"), dpi = 180, width = 8, height = 7)
```

```{r period graphs}
#plotting the results by period
by_period_figure <- ggplot2::ggplot(data = tot_samples, aes(x = d13c, y = d15n, group = period))

#all together
by_period_figure +
  geom_point() +
  aes(
    color = period
  ) +
      theme_minimal() +
      labs(
        x = "δ13C‰",
        y = "δ15N‰",
        title = "Basic plot of tested samples",
        subtitle = "As of 08/08/2020") +
        facet_wrap(~ period)
```

```{r Anglo-Saxon graph}
#Drop empty and unprocessed samples
cats_Anglo_Sax_d <- drop_na(cats_Anglo_Sax, d13c)

#each period colored by site
cats_Anglo_Sax_G <- ggplot2::ggplot(data = cats_Anglo_Sax_d, aes(x = d13c, y = d15n, group = site))

cats_Anglo_Sax_G +
  geom_point() +
  aes(
    color = site
  ) +
      theme(
        plot.title = element_text(hjust = 0.5, face = 'bold'),
        plot.subtitle = element_text(hjust = 0.5),
        panel.background = element_rect(fill = 'white'),
        panel.grid = element_line(color = 'darkgrey'),
        axis.line = element_line(color = 'black'),
        panel.grid.minor = element_line(color = 'white')
      ) +
      labs(
        x = "\u03B413C‰",
        y = "\u03B415N‰",
        title = "Basic Plot of Anglo-Saxon Samples",
        color = "Site"
        ) +
  #axis limits
  coord_cartesian(xlim = c(-23,-16), ylim = c(4,14), expand = FALSE) +
  #tick marks
  scale_x_continuous(breaks = c(-23, -22, -21, -20, -19, -18, -17, -16)) +
  scale_y_continuous(breaks = c(4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
```

```{r Iron Age}
#Drop empty and unprocessed samples
cats_Iron_Age_d <- drop_na(cats_Iron_Age, d13c)

#each period colored by site
cats_Iron_Age_G <- ggplot2::ggplot(data = cats_Iron_Age_d, aes(x = d13c, y = d15n, group = site))

cats_Iron_Age_G +
  geom_point() +
  aes(
    color = site
  ) +
      theme(
        plot.title = element_text(hjust = 0.5, face = 'bold'),
        plot.subtitle = element_text(hjust = 0.5),
        panel.background = element_rect(fill = 'white'),
        panel.grid = element_line(color = 'darkgrey'),
        axis.line = element_line(color = 'black'),
        panel.grid.minor = element_line(color = 'white')
      ) +
      labs(
        x = "\u03B413C‰",
        y = "\u03B415N‰",
        title = "Basic Plot of Iron Age Samples",
        color = "Site"
        ) +
  #axis limits
  coord_cartesian(xlim = c(-23,-16), ylim = c(4,14), expand = FALSE) +
  #tick marks
  scale_x_continuous(breaks = c(-23, -22, -21, -20, -19, -18, -17, -16)) +
  scale_y_continuous(breaks = c(4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14)) 
```

